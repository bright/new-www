{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/charts-on-android-1","result":{"data":{"markdownRemark":{"html":"<p>If you have ever needed to add a chart to your Android app, you certainly have heard about <a href=\"https://github.com/PhilJay/MPAndroidChart\">MPAndroidChart</a> by <a href=\"https://github.com/PhilJay\">PhilJay</a>. If not, consider using this powerful library. Let me show you how easy it is to start!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 522px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0f19f646dcae071909c17663a614e655/04df2/chart_mobile.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAABzGMuCnLS3//EABkQAAMBAQEAAAAAAAAAAAAAAAECAwAiBP/aAAgBAQABBQKradCSUw6EfKEa47//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8BrX//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8BjH//xAAdEAADAAAHAAAAAAAAAAAAAAAAARECEBIhcYGR/9oACAEBAAY/AojS1eMt0LFbV4dH/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARITFBkf/aAAgBAQABPyFLLSuwRauD1NNsgKgSCVj0+pZL/9oADAMBAAIAAwAAABDkD//EABYRAQEBAAAAAAAAAAAAAAAAABEBEP/aAAgBAwEBPxBSrj//xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8QhJj/xAAcEAEAAwEBAAMAAAAAAAAAAAABABEhQXFhgbH/2gAIAQEAAT8Qt+O0NbyDOWAfjscyZLpKnz3BNPEmEgQKQnXbMPWVOpjD7n//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"header img\"\n        title=\"header img\"\n        src=\"/static/0f19f646dcae071909c17663a614e655/04df2/chart_mobile.jpg\"\n        srcset=\"/static/0f19f646dcae071909c17663a614e655/a80bd/chart_mobile.jpg 148w,\n/static/0f19f646dcae071909c17663a614e655/1c91a/chart_mobile.jpg 295w,\n/static/0f19f646dcae071909c17663a614e655/04df2/chart_mobile.jpg 522w\"\n        sizes=\"(max-width: 522px) 100vw, 522px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Goal</h3>\n<p>The goal is to build a simple app written in Kotlin which displays a linear chart with static data. To make it a little bit more interesting we're going to provide data with <code>.csv</code> file. It is very simple format for storing table-based data in the form of text files where values are separated with commas (Comma Separated Values). We'll use an <a href=\"http://opencsv.sourceforge.net/\"><code>OpenCSV</code></a> library to parse it.</p>\n<h3>Dependencies</h3>\n<p>First add dependencies to gradle files.</p>\n<pre><code class=\"language-groovy\">allprojects {\n    repositories {\n        ...\n        maven { url \"https://jitpack.io\" }\n</code></pre>\n<pre><code class=\"language-groovy\">dependencies {\n    ...\n    implementation \"com.github.PhilJay:MPAndroidChart:v3.0.3\"\n    implementation \"com.opencsv:opencsv:4.1\"\n</code></pre>\n<h3>Raw Data Set</h3>\n<p>Find some data, for example from <a href=\"https://www.kaggle.com/datasets\"><em>here</em></a>. I've chosen <a href=\"https://www.kaggle.com/GoogleNewsLab/food-searches-on-google-since-2004\"><em>food searches on Google</em></a> set and cut it a little to display comparison of two searches: <code>banana bread</code> and <code>frozen yogurt</code>. The file looks like this:</p>\n<pre><code class=\"language-csv\">id,googleTopic,week_id,value\nbanana-bread,/m/04cym9,2004-01,30\nbanana-bread,/m/04cym9,2004-02,31\nbanana-bread,/m/04cym9,2004-03,24\nbanana-bread,/m/04cym9,2004-04,27\n...\n</code></pre>\n<p>There are <code>676</code> records in both datasets. Values are normalised, so <code>value</code> is between <code>0</code> and <code>100</code>, where <code>0</code> is the lowest number of searches, <code>100</code> is the largest, and the rest are calculated proportionally.</p>\n<p>Put <code>banana_bread.csv</code> &#x26; <code>frozen_yogurt.csv</code> under <code>/app/res/raw</code> directory in your project.</p>\n<p>Now let's make a <code>data class</code> with corresponding field, the simplest as it can be:</p>\n<p><code>FoodSearch.kt</code>  </p>\n<pre><code class=\"language-kotlin\">package com.bi.chartapp\n\ndata class FoodSearch(\n        val id: String,\n        val googleTopic: String,\n        val week_id: String,\n        val value: Int\n)\n</code></pre>\n<h3>How to parse it?</h3>\n<p>Take a look at the parser below:</p>\n<p><code>Parser.kt</code></p>\n<pre><code class=\"language-kotlin\">package com.bi.chartapp\n\nimport com.opencsv.CSVReaderBuilder\nimport java.io.Reader\n\nclass Parser {\n\n    companion object {\n\n        fun toDataSet(reader: Reader): List&#x3C;FoodSearch> {\n\n            val csvReader = CSVReaderBuilder(reader)\n                    .withSkipLines(1)\n                    .build()\n\n            val foodSearches = mutableListOf&#x3C;FoodSearch>()\n            var record = csvReader.readNext()\n\n            while (record != null) {\n                foodSearches.add(FoodSearch(record[0], record[1], record[2], record[3].toInt()))\n                record = csvReader.readNext()\n            }\n\n            return foodSearches\n        }\n    }\n}\n</code></pre>\n<p>The static method builds a list of <code>FoodSearch</code> records based on the provided <code>Reader</code>. You can get a reader from <code>fileStream</code>, which is provided with activity resources. It looks like this:</p>\n<pre><code class=\"language-kotlin\">val streamBananas = resources.openRawResource(R.raw.banana_bread)\nval bananaData = Parser.toDataSet(streamBananas.reader())\n</code></pre>\n<p>Finally our data looks a little bit more friendly. Time to make a chart!</p>\n<h3>Apply data</h3>\n<p>Add <code>LineChart</code> view to your layout, for example:</p>\n<pre><code class=\"language-xml\">&#x3C;com.github.mikephil.charting.charts.LineChart\n        android:id=\"@+id/lineChart\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"match_parent\"\n        android:layout_centerInParent=\"true\" />\n</code></pre>\n<p>How to manage data now?</p>\n<p><code>LineChart</code> accepts data as an instance of <code>LineData</code> class. <code>LineData</code> is created from at least one instance of <code>LineDataSet</code>. <code>LineDataSet</code> is created from <code>MutableList</code> of <code>Entry</code> objects and <code>String</code> label. Huh. And <code>Entry</code> is an object representing single point on our Chart (basically is an (x,y) representation). It sounds a little bit overwhelming at first, but it is pretty simple. Here are the steps to follow:</p>\n<ol>\n<li>Parse your data from a csv file to a list of any data objects representing a single point on the chart - DONE!</li>\n<li>Map the list of data objects to the list of <code>Entry</code> objects</li>\n<li>Create <code>LineDataSet</code> from the list of entries and label, like \"Banana Bread\"</li>\n<li>Use each of the sets as an argument to create <code>LineData</code> object. Voila.</li>\n</ol>\n<pre><code class=\"language-kotlin\">private fun getEntriesFromCSV(rawResId: Int, label: String): LineDataSet {\n\n    var data: List&#x3C;FoodSearch>? = null\n    resources.openRawResource(rawResId).use { stream ->\n        data = Parser.toDataSet(stream.reader())\n    }\n    val entries: MutableList&#x3C;Entry> = ArrayList()\n\n    data?.mapIndexed { index, foodSearch ->\n        entries.add(\n                Entry(index.toFloat(), foodSearch.value.toFloat(), foodSearch)\n        )\n    }\n\n    return LineDataSet(entries, label)\n}\n</code></pre>\n<p>This function and Parser from the previous paragraph creates <code>LineDataSet</code> from <code>csv</code> resource. Now simply call it for each <code>csv</code> file and create <code>LineData</code>:</p>\n<pre><code class=\"language-kotlin\">val bananaDataSet = getEntriesFromCSV(R.raw.banana_bread, \"Banana Bread\")\nval yogurtDataSet = getEntriesFromCSV(R.raw.frozen_yogurt, \"Frozen Yogurt\")\n\nlineChart.data = LineData(\n        bananaDataSet,\n        yogurtDataSet\n)\n</code></pre>\n<p>That's it, the chart is set up with data!\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a62d00788b5ac7674b0b41dbeff82b2a/9128f/chart_ugly.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+klEQVQoz22QTU8TYRSF508BiS40Ligf0hoXJhYF4oKFO38WleiqNoUYY9wZQxDaaYFOobYd2g6dzrwf970f78JAMbowOTl5cnJPbnKCpZXKg7X3S4W9heXKwvLenW5hsbC3WJjDfb5YqCytVJ48//j42YdHpf2HT/eDF7uf37z7Wn77ZeVltbhd39iqr5arpZ3D9Ve19c1aaedwtVzdeF0vbh+slasbWwfrm7XV8qfi1kFx+zBotoYXURJdTcOzuNNNOt2k2Rp0r6bt8+vWWXzZS5utQSeaRJc3jfYwupqed8Zhe9jtpe3z6wDAeM//lQjNwYigyIQ9eREvJOy9KKuDPFcAzjmc+xzAkQW0AIw4sXih6UjJj5yPtVxobmgOtfRnKjDGICIRuTtnIkYEIoOUOowdH2l/bHzDSM9yZKVp5dRI00iiTaCVAkSFlAJeO4qBh0CRvX1yrPm79qGR2PEI+AYwcTwGTgBjYJ3nQWZtaOXE+hMjofWh9T/vILIyAOo5GQFNHE/xtjZGGQD3LQ+AZ8YGsTLflD81vmX4zHDHcsNwF6TvZAicIGuHgARIyqElVkg5sWGf5DrQACOgX85fWu6DTBwnQBmyQbIO5c8WRDSfhpBUnmWzmdE6IKI0y6aT8SzPZ2mapVNGZLq//9v5B5RSWZY5534DbRwwOCyYPnIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"chart one\"\n        title=\"chart one\"\n        src=\"/static/a62d00788b5ac7674b0b41dbeff82b2a/fcda8/chart_ugly.png\"\n        srcset=\"/static/a62d00788b5ac7674b0b41dbeff82b2a/12f09/chart_ugly.png 148w,\n/static/a62d00788b5ac7674b0b41dbeff82b2a/e4a3f/chart_ugly.png 295w,\n/static/a62d00788b5ac7674b0b41dbeff82b2a/fcda8/chart_ugly.png 590w,\n/static/a62d00788b5ac7674b0b41dbeff82b2a/9128f/chart_ugly.png 603w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Make me beautiful - LineChart properties</h3>\n<p>Time to add some colors and spices. The chart layout configuration is very flexible. I'll show you some basic properties, the rest you may find in the <a href=\"https://github.com/PhilJay/MPAndroidChart/wiki\">documentation</a>. Props are separated between dataset-specific and chart-specific.</p>\n<h5>Tune up data sets</h5>\n<p>First add some colors to the resource <code>colors.xml</code> file in order to make banana look a little bit more like <span style=\"color:#ffe100\">banana</span> and yogurt like <span style=\"color:#0085c7\">yogurt</span>.</p>\n<pre><code class=\"language-xml\">&#x3C;color name=\"banana\">#ffe100&#x3C;/color>\n&#x3C;color name=\"yogurt\">#0085c7&#x3C;/color>\n</code></pre>\n<p>We'll configure each of the <code>LineDataSet</code> object the same way, but with a different color. Check out the method below with the comments:</p>\n<pre><code class=\"language-kotlin\">private fun configureSetLayout(set: LineDataSet, color: Int) {\n\n    set.color = color                         // color of the line\n    set.setDrawFilled(true)                   // fill the space between line and chart bottom\n    set.fillColor = color                     // color of the fill\n    set.setDrawCircles(false)                 // disable drawing circles over each Entry point\n    set.mode = LineDataSet.Mode.CUBIC_BEZIER  // round the line\n    set.fillAlpha = 50                        // make fill transparent with alpha (0-255)\n\n}\n</code></pre>\n<p>Now apply configuration to each dataset:</p>\n<pre><code class=\"language-kotlin\">val bananaColor = resources.getColor(R.color.banana, null)\nval yogurtColor = resources.getColor(R.color.yogurt, null)\n\nconfigureSetLayout(bananaDataSet, bananaColor)\nconfigureSetLayout(yogurtDataSet, yogurtColor)\n</code></pre>\n<h5>Tune up a chart</h5>\n<p>You may configure the chart behaviour in many ways. Default setting allows the user to scale the chart with pinching and scroll it. Since our dataset contains ~700 records let's leave the ability to scale the chart along the axis X and only block the ability to scale it along axis Y. Also remove a description from the right bottom corner and highlighting values by tapping. Like that:</p>\n<pre><code class=\"language-kotlin\">lineChart.description.isEnabled = false\n\nlineChart.isHighlightPerTapEnabled = false\nlineChart.isHighlightPerDragEnabled = false\nlineChart.isScaleYEnabled = false\n</code></pre>\n<p>It works more intuitively already. Now notice that the description above the top X axis are float values. They don't say much unfortunately. It would be better if they marked a year's change every 52 weeks! To achieve this use <code>IAxisValueFormatter</code>. It looks like this:</p>\n<pre><code class=\"language-kotlin\">inner class MyAxisFormatter : IAxisValueFormatter {\n    override fun getFormattedValue(value: Float, axis: AxisBase?): String {\n        return if (value.toInt() % 52 == 0) \"${startingYear + value.toInt() / 52}\"\n        else \"\"\n    }\n}\n</code></pre>\n<p>It means that it will display a value only if it is divisible by 52. And then maps the value to a corresponding year (with starting year set to 2004). We need also a proper granularity so there won't be any grid between years.</p>\n<pre><code class=\"language-kotlin\">lineChart.xAxis.valueFormatter = MyAxisFormatter()\nlineChart.xAxis.granularity = 52f\n</code></pre>\n<p> Also who needs an Y axis on both sides? Disable one of them:</p>\n<pre><code class=\"language-kotlin\">lineChart.axisRight.isEnabled = false\n</code></pre>\n<p> Boom! That's it! Looks nice and presents the data clearly. Pinch to zoom, swipe right and left to get through all these years and finally check when a frozen yogurt beats a banana bread in Google searches!<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e8bed32d37053fce2d6131bcc5e0bd73/9128f/chart_bjutiful.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVQoz2WM3WvTUBiH80c5UQRhF05n7UZBhDlXvdBr/66NiReyDSvKtEty3tPOTVDXtSfnpB9r2jUfS3OSnDQ5qbQr4gc8F7/n4eVVSs/3C0/f3Xm0e+Pe9tLKgpv3Z/zWedlZWtm+9WBnufT27trucunN7cKu8uTVxxevDx+/rBS3KmvlGevlDw839wvPDtbLlWJ5EVc39tbmWtx6XyxXCpsHqxt7ynlr0DJGPxsXlDkGswmzqemcnVuN5oCaLjUX8ftZj9ARMx1q2qztNonVaPaVKORZNpEylXKSyzSfjVRmsZRJLiduJCapzGWWZck0z8cisQIxzVOZ9mV2pfj+OI5FFIskST0uOk6YJmEYNOI4FkmGOn7PNrLwOAzOU+H+sK6w2ZzwWuJ/inlT4TwUsReHnWnqU9upd85kVE8CNRdNy+to9Ou3jp7wI8m/2M5nnR4DVf0rlPHDJGooY38kxnoeVi/tozrTVKIObD0PNWZVNVLFVNMM8DywXYQoAqqrBOgAMq7ygCgBd6Ix6l6iGsOIIp3CcRvYAKkEA8WYAaJw0kanbaQbqMYAGNRN3B+pdNhSRu7oxASVIKCAGeDZe7i+w3NqDHTjr4IZ1ohmDInijT1EASjCDMGc2aA6MhDQBdflDwWVqGTYUoQIrctW+6JtWD3T6vYGXZd73v8E/6gbRMEve5MQEd7HFhMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"chart two\"\n        title=\"chart two\"\n        src=\"/static/e8bed32d37053fce2d6131bcc5e0bd73/fcda8/chart_bjutiful.png\"\n        srcset=\"/static/e8bed32d37053fce2d6131bcc5e0bd73/12f09/chart_bjutiful.png 148w,\n/static/e8bed32d37053fce2d6131bcc5e0bd73/e4a3f/chart_bjutiful.png 295w,\n/static/e8bed32d37053fce2d6131bcc5e0bd73/fcda8/chart_bjutiful.png 590w,\n/static/e8bed32d37053fce2d6131bcc5e0bd73/9128f/chart_bjutiful.png 603w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br>\nOh, it looks like every year around summer! Who would know.</p>\n<h3>Refs:</h3>\n<p><a href=\"https://github.com/PhilJay/MPAndroidChart/wiki\">Wiki</a> &#x26; <a href=\"https://github.com/PhilJay/MPAndroidChart/issues\">Issues</a></p>","excerpt":"If you have ever needed to add a chart to your Android app, you certainly have heard about MPAndroidChart by PhilJay. If not, consider usingâ€¦","frontmatter":{"slug":null,"title":"Your first chart in Android App with CSV parser","description":null,"author":"radek","tags":["android","UI","chart","CSV"],"date":"2018-02-15T23:00:00.000Z","image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/0f19f646dcae071909c17663a614e655/d43af/chart_mobile.jpg","srcSet":"/static/0f19f646dcae071909c17663a614e655/b78ce/chart_mobile.jpg 131w,\n/static/0f19f646dcae071909c17663a614e655/28977/chart_mobile.jpg 261w,\n/static/0f19f646dcae071909c17663a614e655/d43af/chart_mobile.jpg 522w","sizes":"(min-width: 522px) 522px, 100vw"},"sources":[{"srcSet":"/static/0f19f646dcae071909c17663a614e655/cda9f/chart_mobile.webp 131w,\n/static/0f19f646dcae071909c17663a614e655/64ad5/chart_mobile.webp 261w,\n/static/0f19f646dcae071909c17663a614e655/2f054/chart_mobile.webp 522w","type":"image/webp","sizes":"(min-width: 522px) 522px, 100vw"}]},"width":522,"height":390.99999999999994}}}},"timeToRead":7,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-02-16-charts-on-android-1.md"},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-02-16-charts-on-android-1.md"}},"staticQueryHashes":["2189233960","3181594896"]}